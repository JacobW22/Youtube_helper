{% load static %}
{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Youtube helper</title>
    
    <!-- Imports start -->
    <link href="{% static 'bootstrap/bootstrap.min.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/overall.css' %}">  
    <link rel="stylesheet" href="{% static 'css/simple_pages.css' %}">


    <script src="https://kit.fontawesome.com/5cd37e3dba.js" crossorigin="anonymous"></script>
    <script src="{% static 'bootstrap/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'vendor/jquery/jquery-3.2.1.min.js' %}"></script>


    <link rel="icon" type="image/png" href="{% static 'images/icons/favicon.ico' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
    <!-- Imports end -->
</head>
<body>
    
<!-- Navbar start -->
{% url 'youtube_to_spotify' as the_url %}
{% include "navbar.html" with sites_context=sites_context active_site_name="From Youtube to Spotify" active_site_url=the_url %}
<!-- Navbar end -->   

<!-- Main container start -->
<div class="d-flex justify-content-center main-container px-4 flex-column">
    <div class="container-fluid d-flex flex-column align-items-center gap-3 p-0" id="main_form" >


        <!-- Go back section start-->
            <div class="mx-auto go_back_container">
                <a class="text-light highlight_link go_back fs-5" href="{% url 'main_page' %}">
                    <i class="fa-solid fa-arrow-left"></i>&nbsp; Main Page
                </a>
            </div>
        <!-- Go back section end-->
    
            {% if not_auth %}

            <form method="post" class="container-fluid d-flex flex-column align-items-center gap-3 p-0" id="main_form" >
                {% csrf_token %}

                <span class="text-light fs-1 text-center"><i class="fa-brands fa-spotify"></i></span>
                <span class="pointing-to-mail text-light fs-1 text-center">Convert Youtube playlist to Spotify</span>
                <i class="fa-solid fa-chevron-down text-light fs-3"></i>

                <button type="submit" class="d-flex align-items-center sp_login gap-3 animate mt-2">
                    <span class="text-light fs-1 text-center"><i class="fa-brands fa-spotify" style="color: #1DB954;"></i></span>
                    Login with Spotify
                </button>
            
            </form>

            {% else %}
        
            <form method="post" class="container-fluid d-flex flex-column align-items-center zoom gap-3 p-0" id="main_form" >
                {% csrf_token %}

                <span class="text-light fs-1 text-center"><i class="fa-brands fa-spotify"></i></span>
                <span class="pointing-to-mail text-light fs-2 text-center">Convert playlist to Spotify</span>
                <span class="pointing-to-mail text-muted fs-5 text-center">Playlist url:</span>
                {{ form.url|add_class:"form-control"|attr:"placeholder:https://www.youtube.com/playlist?list=PLAYLIST_ID"|attr:"required"}}
                <button type="submit" class="btn btn-dark btn-lg animate mt-3">Convert</button>
            
            </form>

            {% endif %}
        
    </div>
</div>  
<!-- Main container end -->



<!-- Toasts container start-->
<div class="toast-container bottom-0 start-50 translate-middle-x ">
    {% for message in messages %}
    <div class="toast fade text-center text-white border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false"> 
      <div class="toast-body">
          {{ message }}
      </div>
      <button type="button" class="btn-close ms-auto fs-6 mb-2 toast_dismiss" aria-label="Close"></button>
    </div>
    {% endfor %}
  </div>


<div class="toast-container bottom-0 start-50 translate-middle-x mb-5 ">
    {% for field,errors in form.errors.items %}
        {% for error in errors %}
          <div class="toast text-center text-white border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false"> 
              <div class="toast-body">
                {{ error }}
              </div>
            <button type="button" class="btn-close ms-auto fs-6 mb-2 toast_dismiss" aria-label="Close"></button>
          </div>
        {% endfor %}
    {% endfor %}
</div>
<!-- Toasts container end -->	

<script type="text/javascript">

$(document).ready(function(){

    $(".toast").css("opacity", "0");
    $(".toast").toast("show");
    $(".toast").addClass("custom-fade-in").css("opacity", "1");



    $('.input_submit').hover(function() {
        $('.form-control').addClass('align-text-center');
    }, function() {
        $('.form-control').removeClass('align-text-center');
    });

    // Add slideDown animation to Bootstrap dropdown when expanding.
    $('.dropdown').on('show.bs.dropdown', function() {
        $(this).find('.dropdown-menu').first().stop(true, true).slideDown(300);
    });

    // Add slideUp animation to Bootstrap dropdown when collapsing.
    $('.dropdown').on('hide.bs.dropdown', function() {
        $(this).find('.dropdown-menu').hide();
    });


    $(".navbar-toggler-icon").css("background-image", "url(\"data:image/svg+xml,%3Csvg style='color: white' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='40' zoomAndPan='magnify' viewBox='0 0 30 30.000001' height='40' preserveAspectRatio='xMidYMid meet' version='1.0'%3E%3Cdefs%3E%3CclipPath id='id1'%3E%3Cpath d='M 3.386719 7.164062 L 26.613281 7.164062 L 26.613281 22.40625 L 3.386719 22.40625 Z M 3.386719 7.164062 ' clip-rule='nonzero' fill='white'%3E%3C/path%3E%3C/clipPath%3E%3C/defs%3E%3Cg clip-path='url(%23id1)'%3E%3Cpath fill='white' d='M 3.398438 22.40625 L 26.601562 22.40625 L 26.601562 19.867188 L 3.398438 19.867188 Z M 3.398438 16.054688 L 26.601562 16.054688 L 26.601562 13.515625 L 3.398438 13.515625 Z M 3.398438 7.164062 L 3.398438 9.703125 L 26.601562 9.703125 L 26.601562 7.164062 Z M 3.398438 7.164062 ' fill-opacity='1' fill-rule='nonzero'%3E%3C/path%3E%3C/g%3E%3C/svg%3E\")");

    $( ".navbar-toggler" ).click(function() {
        var icon = $(this).children("span");
        var value = $(this).attr('aria-expanded');

        if (value == 'true') {
        icon.css("background-image", "url(\"data:image/svg+xml,%3Csvg style='color: white' xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='currentColor' class='bi bi-chevron-compact-down' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.553 6.776a.5.5 0 0 1 .67-.223L8 9.44l5.776-2.888a.5.5 0 1 1 .448.894l-6 3a.5.5 0 0 1-.448 0l-6-3a.5.5 0 0 1-.223-.67z' fill='white'%3E%3C/path%3E%3C/svg%3E\")")
        }
        else icon.css("background-image", "url(\"data:image/svg+xml,%3Csvg style='color: white' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='40' zoomAndPan='magnify' viewBox='0 0 30 30.000001' height='40' preserveAspectRatio='xMidYMid meet' version='1.0'%3E%3Cdefs%3E%3CclipPath id='id1'%3E%3Cpath d='M 3.386719 7.164062 L 26.613281 7.164062 L 26.613281 22.40625 L 3.386719 22.40625 Z M 3.386719 7.164062 ' clip-rule='nonzero' fill='white'%3E%3C/path%3E%3C/clipPath%3E%3C/defs%3E%3Cg clip-path='url(%23id1)'%3E%3Cpath fill='white' d='M 3.398438 22.40625 L 26.601562 22.40625 L 26.601562 19.867188 L 3.398438 19.867188 Z M 3.398438 16.054688 L 26.601562 16.054688 L 26.601562 13.515625 L 3.398438 13.515625 Z M 3.398438 7.164062 L 3.398438 9.703125 L 26.601562 9.703125 L 26.601562 7.164062 Z M 3.398438 7.164062 ' fill-opacity='1' fill-rule='nonzero'%3E%3C/path%3E%3C/g%3E%3C/svg%3E\")");
    });

});

// Add event listener for click event on the close button
$('.toast .btn-close').on('click', function() {
var toast = $(this).closest('.toast');
// Animate the toast element
toast.animate({
    opacity: 0,
    height: 0,
    marginBottom: 0
}, 500, function() {
    // Remove the toast element from the DOM
    toast.remove();
});
});

</script>
</body>
</html>